{"remainingRequest":"D:\\Workspace\\Web\\221_Web_Programming\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Workspace\\Web\\221_Web_Programming\\client\\src\\pages\\EditBlogPage.vue?vue&type=style&index=0&id=04e9eac2&scoped=true&lang=css&","dependencies":[{"path":"D:\\Workspace\\Web\\221_Web_Programming\\client\\src\\pages\\EditBlogPage.vue","mtime":1655541372414},{"path":"D:\\Workspace\\Web\\221_Web_Programming\\client\\node_modules\\css-loader\\dist\\cjs.js","mtime":1655541768209},{"path":"D:\\Workspace\\Web\\221_Web_Programming\\client\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1655541769422},{"path":"D:\\Workspace\\Web\\221_Web_Programming\\client\\node_modules\\postcss-loader\\src\\index.js","mtime":1655541769225},{"path":"D:\\Workspace\\Web\\221_Web_Programming\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1655541733801},{"path":"D:\\Workspace\\Web\\221_Web_Programming\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":1655541769422}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouZWRpdC1ibG9nLXdyYXBwZXIgew0KICBtYXJnaW46IDUwcHggMCA1MHB4IDA7DQp9DQoNCi5yZXNlcnZhdGlvbi10aXRsZSB7DQogIGZvbnQtZmFtaWx5OiBPbGVvIFNjcmlwdCBTd2FzaCBDYXBzOw0KICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogIGZvbnQtc2l6ZTogNTAwJTsNCiAgbWFyZ2luOiAwcHggMHB4IDUwcHggMHB4Ow0KfQ0KDQoucmVzZXJ2YXRpb24tbm90ZSB7DQogIG1hcmdpbjogMjBweCBhdXRvOw0KICB3aWR0aDogMTAwJTsNCiAgYm9yZGVyLXJhZGl1czogMjBweDsNCiAgYmFja2dyb3VuZC1jb2xvcjogI2VkZWRlZDsNCiAgZGlzcGxheTogZmxleDsNCiAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogIGZsZXgtd3JhcDogd3JhcDsNCn0NCg0KLnJlc2VydmF0aW9uLW5vdGU+KiB7DQogIHdpZHRoOiAxMDAlOw0KfQ0KDQoubm90ZS10aXRsZSB7DQogIGZvbnQtZmFtaWx5OiBSb2JvdG8sICdzYW4tc2VyaWYnOw0KICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogIGZvbnQtc2l6ZTogMjAwJTsNCiAgbWFyZ2luOiAyMHB4IDAgMjBweCAwOw0KfQ0KDQouZm9ybS13cmFwcGVyIHsNCiAgd2lkdGg6IDUwJTsNCiAgbWFyZ2luOiBhdXRvOw0KfQ0KDQpAbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiAxNzAwcHgpIHsNCiAgLmZvcm0td3JhcHBlciB7DQogICAgd2lkdGg6IDYwJTsNCiAgfQ0KfQ0KDQpAbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiAxNDAwcHgpIHsNCiAgLmZvcm0td3JhcHBlciB7DQogICAgd2lkdGg6IDcwJTsNCiAgfQ0KfQ0KDQpAbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiAxMDAwcHgpIHsNCiAgLmZvcm0td3JhcHBlciB7DQogICAgd2lkdGg6IDgwJTsNCiAgfQ0KfQ0KDQpAbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiA3MDBweCkgew0KICAuZm9ybS13cmFwcGVyIHsNCiAgICB3aWR0aDogOTAlOw0KICB9DQp9DQo="},{"version":3,"sources":["EditBlogPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8LA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"EditBlogPage.vue","sourceRoot":"src/pages","sourcesContent":["<template>\r\n  <div class=\"edit-blog-wrapper\">\r\n    <ModalConfirm @toggleModalEvent=\"toggleModalOpen('createBlog')\" :isOpen=\"this.isCreateBlogModalOpen\"\r\n      :title=\"'Create Blog Confirm'\" :content=\"'You are about to create new blog'\" @callbackEvent=\"handleSubmit\" />\r\n    <ModalConfirm @toggleModalEvent=\"toggleModalOpen('editBlog')\" :isOpen=\"this.isEditBlogModalOpen\"\r\n      :title=\"'Edit Blog Confirm'\" :content=\"'You are about to edit your blog'\" @callbackEvent=\"handleSubmit\" />\r\n    <div class=\"reservation-title\">\r\n      <p>Create/Edit Blog</p>\r\n    </div>\r\n    <div class=\"form-wrapper\">\r\n      <Form :type=\"'EditBlog'\" :data=\"formData\" :errorMessages=\"errorMessages\" @onFormChange=\"handleFormChange\"\r\n        @onSubmit=\"\r\n          $route.name === 'adminCreateBlog'\r\n            ? toggleModalOpen('createBlog')\r\n            : toggleModalOpen('editBlog')\r\n        \" />\r\n      <div v-show=\"isFormSubmited\" class=\"reservation-note\" ref=\"note\">\r\n        <div ref=\"noteTitle\" class=\"note-title\"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Form from \"../components/Form.vue\";\r\nimport * as yup from \"yup\";\r\nimport $ from \"jquery\";\r\nimport ModalConfirm from \"../components/ModalConfirm.vue\";\r\n\r\nexport default {\r\n  name: \"EditBlogPage\",\r\n  components: { Form, ModalConfirm },\r\n  data() {\r\n    return {\r\n      isFormSubmited: false,\r\n      currentBlogId: null,\r\n      isCreateBlogModalOpen: false,\r\n      isEditBlogModalOpen: false,\r\n      formData: {\r\n        // Vue Object Data will be convert into Observer\r\n        imageUrl: \"\",\r\n        blogTitle: \"\",\r\n        blogContent: \"\",\r\n      },\r\n      errorMessages: {\r\n        imageUrl: \"\",\r\n        blogTitle: \"\",\r\n        blogContent: \"\",\r\n      },\r\n\r\n      // Add field with name in errorMessages for others' validation\r\n      schema: yup.object().shape({\r\n        blogTitle: yup.string().min(10).label(\"Title\"),\r\n        imageUrl: yup.string().url().min(0).label(\"Image URL\"),\r\n      }),\r\n    };\r\n  },\r\n  beforeMount() {\r\n    this.currentBlogId = this.$route.params.id;\r\n    if (this.currentBlogId) {\r\n      this.GetBlogData();\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    toggleModalOpen(type) {\r\n      if (type === \"createBlog\") {\r\n        this.isCreateBlogModalOpen = !this.isCreateBlogModalOpen;\r\n      } else if (type === \"editBlog\") {\r\n        this.isEditBlogModalOpen = !this.isEditBlogModalOpen;\r\n      }\r\n    },\r\n\r\n    GetBlogData() {\r\n      var settings = {\r\n        url: `${process.env.VUE_APP_API_URL}/blog/{${this.currentBlogId}}`,\r\n        method: \"GET\",\r\n        timeout: 0,\r\n        data: {},\r\n        headers: {},\r\n      };\r\n\r\n      $.ajax(settings).then((response) => {\r\n        response = JSON.parse(response);\r\n        if (response.status === 200) {\r\n          const blog = response.response.blog;\r\n          this.formData.imageUrl = blog.image;\r\n          this.formData.blogTitle = blog.title;\r\n          this.formData.blogContent = blog.content;\r\n        } else {\r\n          alert(\"Cannot get blog to edit\");\r\n        }\r\n      });\r\n    },\r\n\r\n    async handleInputValidation({ name, value }) {\r\n      let validationResult = await this.schema\r\n        .validate({ [name]: value })\r\n        .catch((error) => {\r\n          return error;\r\n        });\r\n      if (validationResult.errors) {\r\n        this.errorMessages[name] = validationResult.errors[0];\r\n        return false;\r\n      } else {\r\n        this.errorMessages[name] = \"\";\r\n        return true;\r\n      }\r\n    },\r\n\r\n    handleFormChange(newData) {\r\n      this.formData[newData.name] = newData.value;\r\n      this.handleInputValidation(newData);\r\n    },\r\n\r\n    async handleSubmit() {\r\n      let titleOK = await this.handleInputValidation({ name: \"blogTitle\", value: this.formData.blogTitle });\r\n      let imageUrlOK = await this.handleInputValidation({ name: \"imageUrl\", value: this.formData.imageUrl });\r\n      if (!titleOK || !imageUrlOK) { this.toggleModalOpen(\"createBlog\"); return; }\r\n      var __this = this;\r\n      const formData = JSON.parse(JSON.stringify(this.formData));\r\n\r\n      const UserToken = localStorage.getItem(\"UserToken\");\r\n      if (UserToken === \"\") {\r\n        alert(\"Please login admin account before to edit or create blog\");\r\n        return;\r\n      }\r\n\r\n      this.isFormSubmited = true;\r\n      if (this.$route.name === \"adminCreateBlog\") {\r\n        /**\r\n         * Handle Edit Profile\r\n         */\r\n        this.toggleModalOpen(\"createBlog\");\r\n        let settings = {\r\n          url: `${process.env.VUE_APP_API_URL}/admin/create_blog`,\r\n          method: \"post\",\r\n          timeout: 0,\r\n          data: {\r\n            image: formData.imageUrl,\r\n            title: formData.blogTitle,\r\n            content: formData.blogContent,\r\n          },\r\n          headers: {\r\n            \"Bear-Token\": UserToken,\r\n          },\r\n        };\r\n        $.ajax(settings).done(function (response) {\r\n          response = JSON.parse(response);\r\n          if (response.status == 200) {\r\n            __this.$refs.noteTitle.innerHTML = \"Your Blog Have Been Created\";\r\n            __this.$router.replace({ name: \"blog\" });\r\n          } else {\r\n            __this.$refs.noteTitle.innerHTML = response.message;\r\n          }\r\n        });\r\n      } else if (this.$route.name === \"adminEditBlog\") {\r\n        /**\r\n         * Handle Edit Password\r\n         */\r\n        this.toggleModalOpen(\"editBlog\");\r\n        let settings = {\r\n          url: `${process.env.VUE_APP_API_URL}/admin/update_blog/{${this.currentBlogId}}`,\r\n          method: \"post\",\r\n          timeout: 0,\r\n          data: {\r\n            image: formData.imageUrl,\r\n            title: formData.blogTitle,\r\n            content: formData.blogContent,\r\n          },\r\n          headers: {\r\n            \"Bear-Token\": UserToken,\r\n          },\r\n        };\r\n        $.ajax(settings).done(function (response) {\r\n          response = JSON.parse(response);\r\n          if (response.status == 200) {\r\n            __this.$refs.noteTitle.innerHTML = \"Your Blog Have Been Edited\";\r\n            __this.$router.replace({ name: \"blog\" });\r\n          } else {\r\n            __this.$refs.noteTitle.innerHTML = response.message;\r\n          }\r\n        });\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.edit-blog-wrapper {\r\n  margin: 50px 0 50px 0;\r\n}\r\n\r\n.reservation-title {\r\n  font-family: Oleo Script Swash Caps;\r\n  text-align: center;\r\n  font-size: 500%;\r\n  margin: 0px 0px 50px 0px;\r\n}\r\n\r\n.reservation-note {\r\n  margin: 20px auto;\r\n  width: 100%;\r\n  border-radius: 20px;\r\n  background-color: #ededed;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.reservation-note>* {\r\n  width: 100%;\r\n}\r\n\r\n.note-title {\r\n  font-family: Roboto, 'san-serif';\r\n  text-align: center;\r\n  font-size: 200%;\r\n  margin: 20px 0 20px 0;\r\n}\r\n\r\n.form-wrapper {\r\n  width: 50%;\r\n  margin: auto;\r\n}\r\n\r\n@media screen and (max-width: 1700px) {\r\n  .form-wrapper {\r\n    width: 60%;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 1400px) {\r\n  .form-wrapper {\r\n    width: 70%;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 1000px) {\r\n  .form-wrapper {\r\n    width: 80%;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 700px) {\r\n  .form-wrapper {\r\n    width: 90%;\r\n  }\r\n}\r\n</style>\r\n"]}]}