{"remainingRequest":"/home/dathuynh/Workspace/221_Web_Programming/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/dathuynh/Workspace/221_Web_Programming/client/src/pages/AdminReservationPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/dathuynh/Workspace/221_Web_Programming/client/src/pages/AdminReservationPage.vue","mtime":1655353835065},{"path":"/home/dathuynh/Workspace/221_Web_Programming/client/node_modules/cache-loader/dist/cjs.js","mtime":1654787234194},{"path":"/home/dathuynh/Workspace/221_Web_Programming/client/node_modules/babel-loader/lib/index.js","mtime":1654787234061},{"path":"/home/dathuynh/Workspace/221_Web_Programming/client/node_modules/cache-loader/dist/cjs.js","mtime":1654787234194},{"path":"/home/dathuynh/Workspace/221_Web_Programming/client/node_modules/vue-loader/lib/index.js","mtime":1654787310467}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAkIGZyb20gImpxdWVyeSI7CmltcG9ydCBBZG1pbkl0ZW0gZnJvbSAiLi4vY29tcG9uZW50cy9BZG1pbkl0ZW0udnVlIjsKLy8gaW1wb3J0IE1vZGFsQ29uZmlybSBmcm9tICIuLi9jb21wb25lbnRzL01vZGFsQ29uZmlybS52dWUiOwpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAiYWRtaW5SZXNlcnZhdGlvbiIsCiAgICBjb21wb25lbnRzOiB7CiAgICAgICAgQWRtaW5JdGVtLAogICAgICAgIC8vTW9kYWxDb25maXJtLAogICAgfSwgY29tcHV0ZWQ6IHsKICAgICAgICBtb2RlbFBhZ2U6IHsKICAgICAgICAgICAgZ2V0KCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFnZTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2V0KHZhbHVlKSB7CiAgICAgICAgICAgICAgICB0aGlzLnBhZ2UgPSB2YWx1ZTsKICAgICAgICAgICAgfSwKICAgICAgICB9LAogICAgfSwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgcGFnZTogMSwKICAgICAgICAgICAgcmVzZXJ2YXRpb25zOiBbXSwKICAgICAgICAgICAgaXNEZWxldGVNb2RhbE9wZW46IGZhbHNlLAogICAgICAgICAgICBpc0Jsb2NrTW9kYWxPcGVuOiBmYWxzZSwKICAgICAgICAgICAgaWRVc2VyOiAwLAogICAgICAgICAgICBpZFVzZXJCbG9jazogMCwKICAgICAgICAgICAgdXNlcnM6IFtdLAogICAgICAgIH07CiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIC8vIHJlbG9hZFBhZ2UoKSB7CiAgICAgICAgLy8gICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgICAvLyAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UoImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9hZG1pbi91c2VyIik7CiAgICAgICAgLy8gfSwKICAgICAgICBvbkNsb3NlUmVzZXJ2YXRpb24oaWQpIHsKICAgICAgICAgICAgdGhpcy4kdm0yLmNsb3NlKGBtb2RhbC1yZXNlcnZhdGlvbi0ke2lkfWApCiAgICAgICAgfSwKICAgICAgICB0b2dnbGVEZWxldGVCdG4oaWQpIHsKICAgICAgICAgICAgdGhpcy5pc0RlbGV0ZU1vZGFsT3BlbiA9ICF0aGlzLmlzRGVsZXRlTW9kYWxPcGVuOwogICAgICAgICAgICB0aGlzLmlkVXNlciA9IGlkOwogICAgICAgIH0sCgogICAgICAgIHRvZ2dsZUJsb2NrQnRuKGlkKSB7CiAgICAgICAgICAgIHRoaXMuaXNCbG9ja01vZGFsT3BlbiA9ICF0aGlzLmlzQmxvY2tNb2RhbE9wZW47CiAgICAgICAgICAgIHRoaXMuaWRVc2VyQmxvY2sgPSBpZDsKICAgICAgICB9LAoKICAgICAgICBibG9ja1VzZXIoKSB7CiAgICAgICAgICAgIHZhciByZXN0VVJMID0gdGhpcy51c2Vyc1twYXJzZUludCh0aGlzLmlkVXNlckJsb2NrKSAtIDFdLmJsb2NrID8gInVuYmxvY2tfdXNlciIgOiAiYmxvY2tfdXNlciI7CiAgICAgICAgICAgIHZhciBzZXR0aW5ncyA9IHsKICAgICAgICAgICAgICAgIHVybDogYCR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9BUElfVVJMfS9hZG1pbi8ke3Jlc3RVUkx9YCwKICAgICAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICAgICAgdGltZW91dDogMCwKICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy51c2Vyc1twYXJzZUludCh0aGlzLmlkVXNlckJsb2NrKSAtIDFdLmVtYWlsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICJCZWFyLVRva2VuIjogbG9jYWxTdG9yYWdlLmdldEl0ZW0oIlVzZXJUb2tlbiIpLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgJC5hamF4KHNldHRpbmdzKQogICAgICAgICAgICAgICAgLmRvbmUoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5nbyh0aGlzLiRyb3V0ZXIuY3VycmVudCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIGRlbGV0ZVVzZXIoKSB7CiAgICAgICAgICAgIHZhciBzZXR0aW5ncyA9IHsKICAgICAgICAgICAgICAgIHVybDogYCR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9BUElfVVJMfS9hZG1pbi9kZWxldGVfdXNlci97JHt0aGlzLmlkVXNlcn19YCwKICAgICAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICAgICAgdGltZW91dDogMCwKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAiQmVhci1Ub2tlbiI6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJVc2VyVG9rZW4iKSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH07CgogICAgICAgICAgICAkLmFqYXgoc2V0dGluZ3MpCiAgICAgICAgICAgICAgICAuZG9uZSgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLmdvKHRoaXMuJHJvdXRlci5jdXJyZW50KQogICAgICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGdldEFsbFJlc2VydmF0aW9ucygpIHsKICAgICAgICAgICAgY29uc3QgX190aGlzID0gdGhpczsKICAgICAgICAgICAgdmFyIHNldHRpbmdzID0gewogICAgICAgICAgICAgICAgdXJsOiBgJHtwcm9jZXNzLmVudi5WVUVfQVBQX0FQSV9VUkx9L2FkbWluL2dldF9hbGxfcmVzZXJ2YXRpb25zYCwKICAgICAgICAgICAgICAgIG1ldGhvZDogIkdFVCIsCiAgICAgICAgICAgICAgICB0aW1lb3V0OiAwLAogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICJCZWFyLVRva2VuIjogbG9jYWxTdG9yYWdlLmdldEl0ZW0oIlVzZXJUb2tlbiIpLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgJC5hamF4KHNldHRpbmdzKQogICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYSA9IEpTT04ucGFyc2UocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgICAgIGlmIChhLnN0YXR1cyAhPSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIkNhbm5vdCBnZXQgYWxsIHJlc2VydmF0aW9ucyIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBfX3RoaXMucmVzZXJ2YXRpb25zID0gYS5yZXNwb25zZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICk7CiAgICAgICAgfSwKICAgICAgICBnZXRVc2VyKCkgewogICAgICAgICAgICBjb25zdCBfX3RoaXMgPSB0aGlzOwogICAgICAgICAgICB2YXIgc2V0dGluZ3MgPSB7CiAgICAgICAgICAgICAgICB1cmw6IGAke3Byb2Nlc3MuZW52LlZVRV9BUFBfQVBJX1VSTH0vYWRtaW4vZ2V0X2Jsb2NrX3VzZXJzYCwKICAgICAgICAgICAgICAgIG1ldGhvZDogIkdFVCIsCiAgICAgICAgICAgICAgICB0aW1lb3V0OiAwLAogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICJCZWFyLVRva2VuIjogbG9jYWxTdG9yYWdlLmdldEl0ZW0oIlVzZXJUb2tlbiIpLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdmFyIGJsb2NrVXNlcnMgPSBbXTsKICAgICAgICAgICAgJC5hamF4KHNldHRpbmdzKS5kb25lKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgYmxvY2tVc2VycyA9IEpTT04ucGFyc2UocmVzcG9uc2UpLnJlc3BvbnNlOwogICAgICAgICAgICAgICAgc2V0dGluZ3MgPSB7CiAgICAgICAgICAgICAgICAgICAgdXJsOiBgJHtwcm9jZXNzLmVudi5WVUVfQVBQX0FQSV9VUkx9L2FkbWluL3VzZXJzYCwKICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICJHRVQiLAogICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ6IDAsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgICAiQmVhci1Ub2tlbiI6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJVc2VyVG9rZW4iKSwKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICQuYWpheChzZXR0aW5ncykKICAgICAgICAgICAgICAgICAgICAuZG9uZShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYSA9IEpTT04ucGFyc2UocmVzcG9uc2UpLnJlc3BvbnNlOwogICAgICAgICAgICAgICAgICAgICAgICBhLmZvckVhY2godXNlciA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkoYmxvY2tVc2VycykuZmluZChibG9ja1VzZXIgPT4gdXNlci5lbWFpbCA9PSBibG9ja1VzZXIpICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIuYmxvY2sgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyLmJsb2NrID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICBfX3RoaXMudXNlcnMgPSBhOwoKCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSk7CgoKICAgICAgICB9LAogICAgfSwKICAgIGJlZm9yZU1vdW50KCkgewogICAgICAgIC8vdGhpcy5nZXRVc2VyKCk7CiAgICAgICAgdGhpcy5nZXRBbGxSZXNlcnZhdGlvbnMoKTsKICAgIH0sCn0K"},{"version":3,"sources":["AdminReservationPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AdminReservationPage.vue","sourceRoot":"src/pages","sourcesContent":["<template>\n    <div style=\"min-height:70%;\">\n        <div class=\"d-flex flex-wrap justify-center\">\n            <AdminItem type=\"ReservationHeader\" :width=\"'100vw'\" :height=\"'100px'\" :imgSize=\"'70px'\"\n                :items=\"['ID', 'Name', 'Date', 'Time']\" />\n        </div>\n        <div class=\"d-flex flex-wrap justify-center\">\n            <div v-for=\"reservation in reservations.filter(\n                (_, index) => index >= (page - 1) * 5 && index <= page * 5 - 1\n            )\" :key=\"reservation.id\">\n                <AdminItem type=\"Reservation\" :width=\"'100vw'\" :height=\"'100px'\" :imgSize=\"'70px'\"\n                    :items=\"[reservation.id, reservation.name, reservation.date, reservation.time]\"\n                    @onSubmit=\"toggleDeleteBtn(user.id)\" @onBlock=\"toggleBlockBtn(user.id)\" />\n                <modal-vue @on-close=\"() => onCloseReservation(reservation.id)\"\n                    :name=\"`modal-reservation-${reservation.id}`\" :headerOptions=\"{\n                        title: 'Reservation Information',\n                    }\" noFooter modalSize=\"lg\">\n                    <div style=\"padding:20px\" class=\"text-center\">\n                        <table>\n                            <tr>\n                                <th>Reservation ID</th>\n                                <td>{{ reservation.id }}</td>\n                            </tr>\n                            <tr>\n                                <th>Username</th>\n                                <td>{{ reservation.name }}</td>\n                            </tr>\n                            <tr>\n                                <th>User Email</th>\n                                <td>{{ reservation.email }}</td>\n                            </tr>\n                            <tr>\n                                <th>User Phone Number</th>\n                                <td>{{ reservation.phoneNumber }}</td>\n                            </tr>\n                            <tr>\n                                <th>Number Of Persons</th>\n                                <td>{{ reservation.NoP }}</td>\n                            </tr>\n                            <tr>\n                                <th>Date</th>\n                                <td>{{ reservation.date }}</td>\n                            </tr>\n                            <tr>\n                                <th>Time</th>\n                                <td>{{ reservation.time }}</td>\n                            </tr>\n                            <tr>\n                                <th>Description</th>\n                                <td>{{ reservation.description }}</td>\n                            </tr>\n                        </table>\n\n                    </div>\n                </modal-vue>\n            </div>\n        </div>\n        <div class=\"text-center\">\n            <v-pagination class=\"mt-4 mb-8\" v-model=\"modelPage\" color=\"#e1651f\" :length=\"\n                reservations.length % 5 === 0\n                    ? Math.floor(reservations.length / 5)\n                    : Math.floor(reservations.length / 5) + 1\n            \" circle></v-pagination>\n        </div>\n    </div>\n</template>\n<style scoped>\ntable,\nth,\ntd {\n    border: 1px solid black;\n    border-collapse: collapse;\n    padding: 10px;\n    margin: auto;\n    width: 80%;\n}\n</style>\n<script>\nimport $ from \"jquery\";\nimport AdminItem from \"../components/AdminItem.vue\";\n// import ModalConfirm from \"../components/ModalConfirm.vue\";\nexport default {\n    name: \"adminReservation\",\n    components: {\n        AdminItem,\n        //ModalConfirm,\n    }, computed: {\n        modelPage: {\n            get() {\n                return this.page;\n            },\n            set(value) {\n                this.page = value;\n            },\n        },\n    },\n    data() {\n        return {\n            page: 1,\n            reservations: [],\n            isDeleteModalOpen: false,\n            isBlockModalOpen: false,\n            idUser: 0,\n            idUserBlock: 0,\n            users: [],\n        };\n    },\n    methods: {\n        // reloadPage() {\n        //     window.location.reload();\n        //     window.location.replace(\"http://localhost:8080/admin/user\");\n        // },\n        onCloseReservation(id) {\n            this.$vm2.close(`modal-reservation-${id}`)\n        },\n        toggleDeleteBtn(id) {\n            this.isDeleteModalOpen = !this.isDeleteModalOpen;\n            this.idUser = id;\n        },\n\n        toggleBlockBtn(id) {\n            this.isBlockModalOpen = !this.isBlockModalOpen;\n            this.idUserBlock = id;\n        },\n\n        blockUser() {\n            var restURL = this.users[parseInt(this.idUserBlock) - 1].block ? \"unblock_user\" : \"block_user\";\n            var settings = {\n                url: `${process.env.VUE_APP_API_URL}/admin/${restURL}`,\n                method: \"POST\",\n                timeout: 0,\n                data: {\n                    email: this.users[parseInt(this.idUserBlock) - 1].email\n                },\n                headers: {\n                    \"Bear-Token\": localStorage.getItem(\"UserToken\"),\n                },\n            };\n            $.ajax(settings)\n                .done(() => {\n                    this.$router.go(this.$router.current);\n                });\n        },\n        deleteUser() {\n            var settings = {\n                url: `${process.env.VUE_APP_API_URL}/admin/delete_user/{${this.idUser}}`,\n                method: \"POST\",\n                timeout: 0,\n                headers: {\n                    \"Bear-Token\": localStorage.getItem(\"UserToken\"),\n                },\n            };\n\n            $.ajax(settings)\n                .done(() => {\n                    this.$router.go(this.$router.current)\n                })\n        },\n        getAllReservations() {\n            const __this = this;\n            var settings = {\n                url: `${process.env.VUE_APP_API_URL}/admin/get_all_reservations`,\n                method: \"GET\",\n                timeout: 0,\n                headers: {\n                    \"Bear-Token\": localStorage.getItem(\"UserToken\"),\n                },\n            };\n            $.ajax(settings)\n                .done(function (response) {\n                    const a = JSON.parse(response);\n                    if (a.status != 200) {\n                        alert(\"Cannot get all reservations\");\n                    }\n                    __this.reservations = a.response;\n                }\n                );\n        },\n        getUser() {\n            const __this = this;\n            var settings = {\n                url: `${process.env.VUE_APP_API_URL}/admin/get_block_users`,\n                method: \"GET\",\n                timeout: 0,\n                headers: {\n                    \"Bear-Token\": localStorage.getItem(\"UserToken\"),\n                },\n            };\n            var blockUsers = [];\n            $.ajax(settings).done(function (response) {\n                blockUsers = JSON.parse(response).response;\n                settings = {\n                    url: `${process.env.VUE_APP_API_URL}/admin/users`,\n                    method: \"GET\",\n                    timeout: 0,\n                    headers: {\n                        \"Bear-Token\": localStorage.getItem(\"UserToken\"),\n                    },\n                };\n                $.ajax(settings)\n                    .done(function (response) {\n                        const a = JSON.parse(response).response;\n                        a.forEach(user => {\n                            if (Array(blockUsers).find(blockUser => user.email == blockUser) != undefined) {\n                                user.block = true;\n                            } else {\n                                user.block = false;\n                            }\n                        });\n                        __this.users = a;\n\n\n                    })\n            });\n\n\n        },\n    },\n    beforeMount() {\n        //this.getUser();\n        this.getAllReservations();\n    },\n}\n</script>"]}]}